<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Rondeteller</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: green;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      transition: background-color 0.5s;
    }

    .ronde-cirkel {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 20px;
      border: 10px solid yellow;
    }

    .knop {
      font-size: 36px;
      padding: 20px 20px;
      border: none;
      border-radius: 12px;
      background-color: yellow;
      color: black;
      cursor: pointer;
      margin: 10px;
      touch-action: manipulation;
    }

    .resetanders {
      font-size: 20px;
      padding: 3px 20px; /* kleiner */
      background-color: red; /* achtergrond kleur */
    }

      #maxRondeInput {
      width: 60px; /* of een andere breedte naar wens */
    }

      #kaartRondesInput {
      width: 400px; /* of een andere breedte naar wens */
    }


    .knop:active {
      transform: scale(0.95);
    }

    .instellingen {
      margin-top: 20px;
      text-align: center;
    }

    input[type="text"], input[type="number"] {
      padding: 5px;
      font-size: 18px;
      margin: 5px;
      width: 200px;
    }

    .fout {
      color: red;
      margin-top: 10px;
    }
.knop-rood {
  background-color: red !important;
  color: white;
}

  </style>
</head>
<body>

  <div class="ronde-cirkel" id="rondeWeergave">
    Ronde 1
    <div id="kaartTekst"></div>
  </div>

<button class="knop" id="volgendeKnop" onclick="beveiligdeVolgendeRonde()">Volgende ronde</button>

  <button class="knop resetanders" onclick="resetRonde()">Reset</button>

  <div class="instellingen">

    Max. aantal rondes: 
    <input type="number" id="maxRondeInput" value="20" onchange="updateMaxRonde(this.value)">

    <br>
    Kaartuitgifte bij rondes (bijv. 10, 15):<br>
    <input type="text" id="kaartRondesInput" value="10,15" onchange="updateKaartRondes(this.value)">
    <br>
    <label>
      <input type="checkbox" id="geluidToggle" checked onchange="toggleGeluid()">
      Geluid aan
    </label>
    <div class="fout" id="foutMelding"></div>
  </div>

  <script>
    let ronde = parseInt(localStorage.getItem("ronde")) || 1;
    let maxRonde = parseInt(localStorage.getItem("maxRonde")) || 20;
    let kaartRondes = JSON.parse(localStorage.getItem("kaartRondes")) || [10, 15];
    let geluidAan = localStorage.getItem("geluidAan") !== "false";
    let audioFoutGemeld = false;

    const rondeWeergave = document.getElementById("rondeWeergave");
    const kaartTekst = document.getElementById("kaartTekst");
    const foutMelding = document.getElementById("foutMelding");

    document.getElementById("maxRondeInput").value = maxRonde;
    document.getElementById("kaartRondesInput").value = kaartRondes.join(",");
    document.getElementById("geluidToggle").checked = geluidAan;

    function updateWeergave() {
      rondeWeergave.textContent = "Ronde " + ronde;
      if (kaartRondes.includes(ronde)) {
        kaartTekst.textContent = "Koop Kaart!";
        document.body.style.backgroundColor = "red";
        flashRood();
        if (geluidAan) speelGeluid();
      } else {
        kaartTekst.textContent = "";
        document.body.style.backgroundColor = "green";
      }
      localStorage.setItem("ronde", ronde);
    }

    function flashRood() {
      document.body.style.backgroundColor = "red";
      setTimeout(() => {
        document.body.style.backgroundColor = "green";
      }, 300);
    }

function speelGeluid() {
  const audio = new Audio("ding.mp3");

  audio.play().then(() => {
    // Geluid succesvol afgespeeld, dus doe niks
  }).catch(err => {
    // Alleen tonen als het geluid echt niet speelt én audioFout nog niet gemeld is
    if (!audioFoutGemeld && !audioPlayedRecently()) {
      foutMelding.textContent = "⚠️ Kan 'ding.mp3' niet afspelen. Controleer of het bestand bestaat.";
      audioFoutGemeld = true;
    }
  });
}

// Hulpfunctie om kort te meten of geluid recent afgespeeld werd
let lastAudioTime = 0;
function audioPlayedRecently() {
  const now = Date.now();
  if (now - lastAudioTime < 2000) return true;
  lastAudioTime = now;
  return false;
}


    function volgendeRonde() {
      ronde = ronde >= maxRonde ? 1 : ronde + 1;
      updateWeergave();
    }

    function resetRonde() {
      ronde = 1;
      updateWeergave();
    }



    function updateMaxRonde(value) {
      maxRonde = parseInt(value) || 20;
      localStorage.setItem("maxRonde", maxRonde);
    }

    function updateKaartRondes(value) {
      const lijst = value.split(",").map(v => parseInt(v.trim())).filter(v => !isNaN(v));
      kaartRondes = lijst;
      localStorage.setItem("kaartRondes", JSON.stringify(kaartRondes));
    }

    function toggleGeluid() {
      geluidAan = document.getElementById("geluidToggle").checked;
      localStorage.setItem("geluidAan", geluidAan);
    }

    updateWeergave();

function beveiligdeVolgendeRonde() {
  const knop = document.getElementById("volgendeKnop");

  // Uitschakelen en rood maken
  knop.disabled = true;
  knop.classList.add("knop-rood");

  volgendeRonde(); // originele functie uitvoeren

  // Na 5 seconden weer inschakelen en kleur herstellen
  setTimeout(() => {
    knop.disabled = false;
    knop.classList.remove("knop-rood");
  }, 5000);
}

  </script>
</body>
</html>
